<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-2"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">HsProof.Proof</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span>                   </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-operator">(^.)</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-operator">(&gt;=&gt;)</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span>           </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">runExceptT</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans</span></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Except</span></span><span>     </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">except</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.State</span></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">get</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HsProof.ProofRef.html"><span class="hs-identifier">HsProof.ProofRef</span></a></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="HsProof.Types.html"><span class="hs-identifier">HsProof.Types</span></a></span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-comment">-- | admit</span><span>
</span><span id="line-14"></span><span id="local-6989586621679140123"><span class="annot"><a href="HsProof.Proof.html#admitted"><span class="hs-identifier hs-type">admitted</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HsProof.Types.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679140123"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-15"></span><span id="admitted"><span class="annot"><span class="annottext">admitted :: Proof a
</span><a href="HsProof.Proof.html#admitted"><span class="hs-identifier hs-var hs-var">admitted</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either Result a -&gt; Proof a
forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">(Either Result a -&gt; Proof a) -&gt; Either Result a -&gt; Proof a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Result -&gt; Either Result a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="HsProof.Types.html#Proved"><span class="hs-identifier hs-var">Proved</span></a></span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-comment">-- | finish the proof </span><span>
</span><span id="line-18"></span><span id="local-6989586621679140120"><span class="annot"><a href="HsProof.Proof.html#qed"><span class="hs-identifier hs-type">qed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HsProof.Types.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679140120"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-19"></span><span id="qed"><span class="annot"><span class="annottext">qed :: Proof a
</span><a href="HsProof.Proof.html#qed"><span class="hs-identifier hs-var hs-var">qed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-20"></span><span>    </span><span id="local-6989586621679140118"><span class="annot"><span class="annottext">PropRef
</span><a href="#local-6989586621679140118"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT PropRef Identity PropRef
-&gt; ExceptT Result (StateT PropRef Identity) PropRef
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">StateT PropRef Identity PropRef
forall (m :: * -&gt; *) s. Monad m =&gt; StateT s m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><span class="annottext">Either Result a -&gt; Proof a
forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">(Either Result a -&gt; Proof a) -&gt; Either Result a -&gt; Proof a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PropRef -&gt; [Prop]
</span><a href="HsProof.Types.html#_goal"><span class="hs-identifier hs-var hs-var">_goal</span></a></span><span> </span><span class="annot"><span class="annottext">PropRef
</span><a href="#local-6989586621679140118"><span class="hs-identifier hs-var">ref</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-22"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Either Result a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="HsProof.Types.html#Proved"><span class="hs-identifier hs-var">Proved</span></a></span><span>
</span><span id="line-23"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679140115"><span class="annot"><span class="annottext">x :: Prop
</span><a href="#local-6989586621679140115"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Either Result a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prop -&gt; Result
</span><a href="HsProof.Types.html#Failed"><span class="hs-identifier hs-var">Failed</span></a></span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679140115"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-comment">-- | abort the proof and return current goal</span><span>
</span><span id="line-26"></span><span id="local-6989586621679140113"><span class="annot"><a href="HsProof.Proof.html#abort"><span class="hs-identifier hs-type">abort</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HsProof.Types.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679140113"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-27"></span><span id="abort"><span class="annot"><span class="annottext">abort :: Proof a
</span><a href="HsProof.Proof.html#abort"><span class="hs-identifier hs-var hs-var">abort</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-28"></span><span>    </span><span id="local-6989586621679140111"><span class="annot"><span class="annottext">PropRef
</span><a href="#local-6989586621679140111"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT PropRef Identity PropRef
-&gt; ExceptT Result (StateT PropRef Identity) PropRef
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">StateT PropRef Identity PropRef
forall (m :: * -&gt; *) s. Monad m =&gt; StateT s m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><span class="annottext">Either Result a -&gt; Proof a
forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">(Either Result a -&gt; Proof a) -&gt; Either Result a -&gt; Proof a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PropRef -&gt; [Prop]
</span><a href="HsProof.Types.html#_goal"><span class="hs-identifier hs-var hs-var">_goal</span></a></span><span> </span><span class="annot"><span class="annottext">PropRef
</span><a href="#local-6989586621679140111"><span class="hs-identifier hs-var">ref</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-30"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Either Result a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prop -&gt; Result
</span><a href="HsProof.Types.html#Failed"><span class="hs-identifier hs-var">Failed</span></a></span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="HsProof.Types.html#None"><span class="hs-identifier hs-var">None</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679140109"><span class="annot"><span class="annottext">x :: Prop
</span><a href="#local-6989586621679140109"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Either Result a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prop -&gt; Result
</span><a href="HsProof.Types.html#Failed"><span class="hs-identifier hs-var">Failed</span></a></span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679140109"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-comment">-- | show all proof content</span><span>
</span><span id="line-34"></span><span class="annot"><a href="HsProof.Proof.html#status"><span class="hs-identifier hs-type">status</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HsProof.Types.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="HsProof.Types.html#PropRef"><span class="hs-identifier hs-type">PropRef</span></a></span><span>
</span><span id="line-35"></span><span id="status"><span class="annot"><span class="annottext">status :: ExceptT Result (StateT PropRef Identity) PropRef
</span><a href="HsProof.Proof.html#status"><span class="hs-identifier hs-var hs-var">status</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT PropRef Identity PropRef
-&gt; ExceptT Result (StateT PropRef Identity) PropRef
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">StateT PropRef Identity PropRef
forall (m :: * -&gt; *) s. Monad m =&gt; StateT s m s
</span><span class="hs-identifier hs-var">get</span></span><span> </span><span class="annot"><span class="annottext">ExceptT Result (StateT PropRef Identity) PropRef
-&gt; (PropRef -&gt; ExceptT Result (StateT PropRef Identity) PropRef)
-&gt; ExceptT Result (StateT PropRef Identity) PropRef
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Either Result PropRef
-&gt; ExceptT Result (StateT PropRef Identity) PropRef
forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">(Either Result PropRef
 -&gt; ExceptT Result (StateT PropRef Identity) PropRef)
-&gt; (PropRef -&gt; Either Result PropRef)
-&gt; PropRef
-&gt; ExceptT Result (StateT PropRef Identity) PropRef
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PropRef -&gt; Either Result PropRef
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-comment">-- | exfalso: F -&gt; anything</span><span>
</span><span id="line-38"></span><span class="annot"><a href="HsProof.Proof.html#exfalso"><span class="hs-identifier hs-type">exfalso</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HsProof.Types.html#ObjectId"><span class="hs-identifier hs-type">ObjectId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HsProof.Types.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span id="exfalso"><span class="annot"><span class="annottext">exfalso :: ObjectId -&gt; Proof ()
</span><a href="HsProof.Proof.html#exfalso"><span class="hs-identifier hs-var hs-var">exfalso</span></a></span></span><span> </span><span id="local-6989586621679140105"><span class="annot"><span class="annottext">i :: ObjectId
</span><a href="#local-6989586621679140105"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-40"></span><span>    </span><span id="local-6989586621679140104"><span class="annot"><span class="annottext">PropRef
</span><a href="#local-6989586621679140104"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT PropRef Identity PropRef
-&gt; ExceptT Result (StateT PropRef Identity) PropRef
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">StateT PropRef Identity PropRef
forall (m :: * -&gt; *) s. Monad m =&gt; StateT s m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-41"></span><span>    </span><span id="local-6989586621679140103"><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679140103"><span class="hs-identifier hs-var">k</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ObjectId -&gt; Proof Prop
</span><a href="HsProof.ProofRef.html#getProofObject"><span class="hs-identifier hs-var">getProofObject</span></a></span><span> </span><span class="annot"><span class="annottext">ObjectId
</span><a href="#local-6989586621679140105"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679140103"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-43"></span><span>        </span><span class="annot"><a href="HsProof.Types.html#F"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Proof ()
</span><a href="HsProof.ProofRef.html#finishGoal"><span class="hs-identifier hs-var">finishGoal</span></a></span><span>
</span><span id="line-44"></span><span>        </span><span id="local-6989586621679140099"><span class="annot"><span class="annottext">x :: Prop
</span><a href="#local-6989586621679140099"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either Result () -&gt; Proof ()
forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">(Either Result () -&gt; Proof ()) -&gt; Either Result () -&gt; Proof ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Result -&gt; Either Result ()
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prop -&gt; Result
</span><a href="HsProof.Types.html#Failed"><span class="hs-identifier hs-var">Failed</span></a></span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679140099"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">-- | apply theorem/prop to the goal</span><span>
</span><span id="line-47"></span><span id="local-6989586621679140162"><span class="annot"><a href="HsProof.Proof.html#apply%27"><span class="hs-identifier hs-type">apply'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HsProof.Types.html#Appliable"><span class="hs-identifier hs-type">Appliable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679140162"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="HsProof.Types.html#Prop"><span class="hs-identifier hs-type">Prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679140162"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HsProof.Types.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-48"></span><span id="apply%27"><span class="annot"><span class="annottext">apply' :: a -&gt; Proof ()
</span><a href="HsProof.Proof.html#apply%27"><span class="hs-identifier hs-var hs-var">apply'</span></a></span></span><span> </span><span id="local-6989586621679140097"><span class="annot"><span class="annottext">p :: a
</span><a href="#local-6989586621679140097"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-49"></span><span>    </span><span id="local-6989586621679140096"><span class="annot"><span class="annottext">PropRef
</span><a href="#local-6989586621679140096"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT PropRef Identity PropRef
-&gt; ExceptT Result (StateT PropRef Identity) PropRef
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">StateT PropRef Identity PropRef
forall (m :: * -&gt; *) s. Monad m =&gt; StateT s m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; Prop -&gt; Either Result Prop
forall a b. Appliable a b =&gt; a -&gt; b -&gt; Either Result Prop
</span><a href="HsProof.Types.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679140097"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Prop -&gt; Either Result Prop)
-&gt; (PropRef -&gt; Prop) -&gt; PropRef -&gt; Either Result Prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Prop] -&gt; Prop
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([Prop] -&gt; Prop) -&gt; (PropRef -&gt; [Prop]) -&gt; PropRef -&gt; Prop
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PropRef -&gt; [Prop]
</span><a href="HsProof.Types.html#_goal"><span class="hs-identifier hs-var hs-var">_goal</span></a></span><span> </span><span class="annot"><span class="annottext">(PropRef -&gt; Either Result Prop) -&gt; PropRef -&gt; Either Result Prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PropRef
</span><a href="#local-6989586621679140096"><span class="hs-identifier hs-var">ref</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-51"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>  </span><span class="annot"><a href="HsProof.Types.html#Proved"><span class="hs-identifier hs-type">Proved</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Proof ()
</span><a href="HsProof.ProofRef.html#finishGoal"><span class="hs-identifier hs-var">finishGoal</span></a></span><span>
</span><span id="line-52"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="HsProof.Types.html#Failed"><span class="hs-identifier hs-type">Failed</span></a></span><span> </span><span id="local-6989586621679140093"><span class="annot"><span class="annottext">p' :: Prop
</span><a href="#local-6989586621679140093"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either Result () -&gt; Proof ()
forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">(Either Result () -&gt; Proof ()) -&gt; Either Result () -&gt; Proof ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Result -&gt; Either Result ()
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prop -&gt; Result
</span><a href="HsProof.Types.html#Failed"><span class="hs-identifier hs-var">Failed</span></a></span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679140093"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679140092"><span class="annot"><span class="annottext">p' :: Prop
</span><a href="#local-6989586621679140092"><span class="hs-identifier hs-var">p'</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prop -&gt; Proof ()
</span><a href="HsProof.ProofRef.html#mutGoal"><span class="hs-identifier hs-var">mutGoal</span></a></span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679140092"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- | same as apply', but using ObjectId</span><span>
</span><span id="line-56"></span><span class="annot"><a href="HsProof.Proof.html#apply"><span class="hs-identifier hs-type">apply</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HsProof.Types.html#ObjectId"><span class="hs-identifier hs-type">ObjectId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HsProof.Types.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span id="apply"><span class="annot"><span class="annottext">apply :: ObjectId -&gt; Proof ()
</span><a href="HsProof.Proof.html#apply"><span class="hs-identifier hs-var hs-var">apply</span></a></span></span><span> </span><span id="local-6989586621679140089"><span class="annot"><span class="annottext">i :: ObjectId
</span><a href="#local-6989586621679140089"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prop -&gt; Proof ()
forall a. Appliable a Prop =&gt; a -&gt; Proof ()
</span><a href="HsProof.Proof.html#apply%27"><span class="hs-identifier hs-var">apply'</span></a></span><span> </span><span class="annot"><span class="annottext">(Prop -&gt; Proof ()) -&gt; Proof Prop -&gt; Proof ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">ObjectId -&gt; Proof Prop
</span><a href="HsProof.ProofRef.html#getProofObject"><span class="hs-identifier hs-var">getProofObject</span></a></span><span> </span><span class="annot"><span class="annottext">ObjectId
</span><a href="#local-6989586621679140089"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">-- | apply to multiple props and create a new prop object</span><span>
</span><span id="line-60"></span><span id="local-6989586621679140152"><span class="annot"><a href="HsProof.Proof.html#applyToM"><span class="hs-identifier hs-type">applyToM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HsProof.Types.html#Appliable"><span class="hs-identifier hs-type">Appliable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679140152"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="HsProof.Types.html#Prop"><span class="hs-identifier hs-type">Prop</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679140152"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="HsProof.Types.html#ObjectId"><span class="hs-identifier hs-type">ObjectId</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HsProof.Types.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="HsProof.Types.html#ObjectId"><span class="hs-identifier hs-type">ObjectId</span></a></span></span><span>
</span><span id="line-61"></span><span id="applyToM"><span class="annot"><span class="annottext">applyToM :: a -&gt; [ObjectId] -&gt; Proof ObjectId
</span><a href="HsProof.Proof.html#applyToM"><span class="hs-identifier hs-var hs-var">applyToM</span></a></span></span><span> </span><span id="local-6989586621679140086"><span class="annot"><span class="annottext">p :: a
</span><a href="#local-6989586621679140086"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679140085"><span class="annot"><span class="annottext">is :: [ObjectId]
</span><a href="#local-6989586621679140085"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-62"></span><span>    </span><span id="local-6989586621679140084"><span class="annot"><span class="annottext">PropRef
</span><a href="#local-6989586621679140084"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT PropRef Identity PropRef
-&gt; ExceptT Result (StateT PropRef Identity) PropRef
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">StateT PropRef Identity PropRef
forall (m :: * -&gt; *) s. Monad m =&gt; StateT s m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-63"></span><span>    </span><span id="local-6989586621679140083"><span class="annot"><span class="annottext">[Prop]
</span><a href="#local-6989586621679140083"><span class="hs-identifier hs-var">ks</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ObjectId -&gt; Proof Prop)
-&gt; [ObjectId] -&gt; ExceptT Result (StateT PropRef Identity) [Prop]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">ObjectId -&gt; Proof Prop
</span><a href="HsProof.ProofRef.html#getProofObject"><span class="hs-identifier hs-var">getProofObject</span></a></span><span> </span><span class="annot"><span class="annottext">[ObjectId]
</span><a href="#local-6989586621679140085"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; [Prop] -&gt; Either Result Prop
forall a b. Appliable a b =&gt; a -&gt; b -&gt; Either Result Prop
</span><a href="HsProof.Types.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679140086"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[Prop]
</span><a href="#local-6989586621679140083"><span class="hs-identifier hs-var">ks</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-65"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679140081"><span class="annot"><span class="annottext">p' :: Prop
</span><a href="#local-6989586621679140081"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prop -&gt; Proof ObjectId
</span><a href="HsProof.ProofRef.html#newProofObject"><span class="hs-identifier hs-var">newProofObject</span></a></span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679140081"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-66"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>  </span><span id="local-6989586621679140079"><span class="annot"><span class="annottext">f :: Result
</span><a href="#local-6989586621679140079"><span class="hs-identifier hs-var">f</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either Result ObjectId -&gt; Proof ObjectId
forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; Either Result ObjectId
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679140079"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | &lt;applyM&gt;, but modify one instead of creating a new one</span><span>
</span><span id="line-69"></span><span id="local-6989586621679140078"><span class="annot"><a href="HsProof.Proof.html#applyToM%27"><span class="hs-identifier hs-type">applyToM'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HsProof.Types.html#Appliable"><span class="hs-identifier hs-type">Appliable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679140078"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="HsProof.Types.html#Prop"><span class="hs-identifier hs-type">Prop</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679140078"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="HsProof.Types.html#ObjectId"><span class="hs-identifier hs-type">ObjectId</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HsProof.Types.html#ObjectId"><span class="hs-identifier hs-type">ObjectId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HsProof.Types.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-70"></span><span id="applyToM%27"><span class="annot"><span class="annottext">applyToM' :: a -&gt; [ObjectId] -&gt; ObjectId -&gt; Proof ()
</span><a href="HsProof.Proof.html#applyToM%27"><span class="hs-identifier hs-var hs-var">applyToM'</span></a></span></span><span> </span><span id="local-6989586621679140076"><span class="annot"><span class="annottext">t :: a
</span><a href="#local-6989586621679140076"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679140075"><span class="annot"><span class="annottext">ps :: [ObjectId]
</span><a href="#local-6989586621679140075"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679140074"><span class="annot"><span class="annottext">o :: ObjectId
</span><a href="#local-6989586621679140074"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679140076"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [ObjectId] -&gt; Proof ObjectId
forall a. Appliable a [Prop] =&gt; a -&gt; [ObjectId] -&gt; Proof ObjectId
</span><a href="HsProof.Proof.html#applyToM"><span class="hs-operator hs-var">`applyToM`</span></a></span><span> </span><span class="annot"><span class="annottext">[ObjectId]
</span><a href="#local-6989586621679140075"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Proof ObjectId -&gt; (ObjectId -&gt; Proof Prop) -&gt; Proof Prop
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ObjectId -&gt; Proof Prop
</span><a href="HsProof.ProofRef.html#getProofObject"><span class="hs-identifier hs-var">getProofObject</span></a></span><span> </span><span class="annot"><span class="annottext">Proof Prop -&gt; (Prop -&gt; Proof ()) -&gt; Proof ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">ObjectId -&gt; Prop -&gt; Proof ()
</span><a href="HsProof.ProofRef.html#mutProofObject"><span class="hs-identifier hs-var">mutProofObject</span></a></span><span> </span><span class="annot"><span class="annottext">ObjectId
</span><a href="#local-6989586621679140074"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-comment">-- | apply to a &lt;Prop&gt;</span><span>
</span><span id="line-73"></span><span id="local-6989586621679140147"><span class="annot"><a href="HsProof.Proof.html#applyTo%27"><span class="hs-identifier hs-type">applyTo'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HsProof.Types.html#Appliable"><span class="hs-identifier hs-type">Appliable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679140147"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="HsProof.Types.html#Prop"><span class="hs-identifier hs-type">Prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679140147"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HsProof.Types.html#ObjectId"><span class="hs-identifier hs-type">ObjectId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HsProof.Types.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-74"></span><span id="applyTo%27"><span class="annot"><span class="annottext">applyTo' :: a -&gt; ObjectId -&gt; Proof ()
</span><a href="HsProof.Proof.html#applyTo%27"><span class="hs-identifier hs-var hs-var">applyTo'</span></a></span></span><span> </span><span id="local-6989586621679140071"><span class="annot"><span class="annottext">p :: a
</span><a href="#local-6989586621679140071"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679140070"><span class="annot"><span class="annottext">i :: ObjectId
</span><a href="#local-6989586621679140070"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-75"></span><span>    </span><span id="local-6989586621679140069"><span class="annot"><span class="annottext">PropRef
</span><a href="#local-6989586621679140069"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT PropRef Identity PropRef
-&gt; ExceptT Result (StateT PropRef Identity) PropRef
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">StateT PropRef Identity PropRef
forall (m :: * -&gt; *) s. Monad m =&gt; StateT s m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-76"></span><span>    </span><span id="local-6989586621679140068"><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679140068"><span class="hs-identifier hs-var">k</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ObjectId -&gt; Proof Prop
</span><a href="HsProof.ProofRef.html#getProofObject"><span class="hs-identifier hs-var">getProofObject</span></a></span><span> </span><span class="annot"><span class="annottext">ObjectId
</span><a href="#local-6989586621679140070"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; Prop -&gt; Either Result Prop
forall a b. Appliable a b =&gt; a -&gt; b -&gt; Either Result Prop
</span><a href="HsProof.Types.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679140071"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679140068"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-78"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679140067"><span class="annot"><span class="annottext">p' :: Prop
</span><a href="#local-6989586621679140067"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ObjectId -&gt; Prop -&gt; Proof ()
</span><a href="HsProof.ProofRef.html#mutProofObject"><span class="hs-identifier hs-var">mutProofObject</span></a></span><span> </span><span class="annot"><span class="annottext">ObjectId
</span><a href="#local-6989586621679140070"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679140067"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-79"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>  </span><span id="local-6989586621679140066"><span class="annot"><span class="annottext">f :: Result
</span><a href="#local-6989586621679140066"><span class="hs-identifier hs-var">f</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either Result () -&gt; Proof ()
forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; Either Result ()
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679140066"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">-- | same as &lt;applyTo'&gt;, but using &lt;ObjectId&gt;</span><span>
</span><span id="line-82"></span><span class="annot"><a href="HsProof.Proof.html#applyTo"><span class="hs-identifier hs-type">applyTo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HsProof.Types.html#ObjectId"><span class="hs-identifier hs-type">ObjectId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HsProof.Types.html#ObjectId"><span class="hs-identifier hs-type">ObjectId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HsProof.Types.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span id="applyTo"><span class="annot"><span class="annottext">applyTo :: ObjectId -&gt; ObjectId -&gt; Proof ()
</span><a href="HsProof.Proof.html#applyTo"><span class="hs-identifier hs-var hs-var">applyTo</span></a></span></span><span> </span><span id="local-6989586621679140064"><span class="annot"><span class="annottext">t :: ObjectId
</span><a href="#local-6989586621679140064"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679140063"><span class="annot"><span class="annottext">p :: ObjectId
</span><a href="#local-6989586621679140063"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Prop -&gt; ObjectId -&gt; Proof ()) -&gt; ObjectId -&gt; Prop -&gt; Proof ()
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Prop -&gt; ObjectId -&gt; Proof ()
forall a. Appliable a Prop =&gt; a -&gt; ObjectId -&gt; Proof ()
</span><a href="HsProof.Proof.html#applyTo%27"><span class="hs-identifier hs-var">applyTo'</span></a></span><span> </span><span class="annot"><span class="annottext">ObjectId
</span><a href="#local-6989586621679140063"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(Prop -&gt; Proof ()) -&gt; Proof Prop -&gt; Proof ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">ObjectId -&gt; Proof Prop
</span><a href="HsProof.ProofRef.html#getProofObject"><span class="hs-identifier hs-var">getProofObject</span></a></span><span> </span><span class="annot"><span class="annottext">ObjectId
</span><a href="#local-6989586621679140064"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">-- | like intro in coq</span><span>
</span><span id="line-86"></span><span class="annot"><a href="HsProof.Proof.html#intro"><span class="hs-identifier hs-type">intro</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HsProof.Types.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="HsProof.Types.html#ObjectId"><span class="hs-identifier hs-type">ObjectId</span></a></span><span>
</span><span id="line-87"></span><span id="intro"><span class="annot"><span class="annottext">intro :: Proof ObjectId
</span><a href="HsProof.Proof.html#intro"><span class="hs-identifier hs-var hs-var">intro</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-88"></span><span>    </span><span id="local-6989586621679140060"><span class="annot"><span class="annottext">PropRef
</span><a href="#local-6989586621679140060"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT PropRef Identity PropRef
-&gt; ExceptT Result (StateT PropRef Identity) PropRef
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">StateT PropRef Identity PropRef
forall (m :: * -&gt; *) s. Monad m =&gt; StateT s m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PropRef
</span><a href="#local-6989586621679140060"><span class="hs-identifier hs-var">ref</span></a></span><span> </span><span class="annot"><span class="annottext">PropRef -&gt; Getting [Prop] PropRef [Prop] -&gt; [Prop]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [Prop] PropRef [Prop]
Lens' PropRef [Prop]
</span><a href="HsProof.Types.html#goal"><span class="hs-identifier hs-var">goal</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-90"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679140058"><span class="annot"><span class="annottext">x :: Prop
</span><a href="#local-6989586621679140058"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679140058"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-91"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679140057"><span class="annot"><span class="annottext">p :: Prop
</span><a href="#local-6989586621679140057"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><a href="HsProof.Types.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span> </span><span id="local-6989586621679140055"><span class="annot"><span class="annottext">q :: Prop
</span><a href="#local-6989586621679140055"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prop -&gt; Proof ()
</span><a href="HsProof.ProofRef.html#mutGoal"><span class="hs-identifier hs-var">mutGoal</span></a></span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679140055"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Proof () -&gt; Proof ObjectId -&gt; Proof ObjectId
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Prop -&gt; Proof ObjectId
</span><a href="HsProof.ProofRef.html#newProofObject"><span class="hs-identifier hs-var">newProofObject</span></a></span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679140057"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-92"></span><span>            </span><span class="hs-identifier">_</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either Result ObjectId -&gt; Proof ObjectId
forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">(Either Result ObjectId -&gt; Proof ObjectId)
-&gt; Either Result ObjectId -&gt; Proof ObjectId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Result -&gt; Either Result ObjectId
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prop -&gt; Result
</span><a href="HsProof.Types.html#Failed"><span class="hs-identifier hs-var">Failed</span></a></span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679140058"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either Result ObjectId -&gt; Proof ObjectId
forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">(Either Result ObjectId -&gt; Proof ObjectId)
-&gt; Either Result ObjectId -&gt; Proof ObjectId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Result -&gt; Either Result ObjectId
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prop -&gt; Result
</span><a href="HsProof.Types.html#Failed"><span class="hs-identifier hs-var">Failed</span></a></span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="HsProof.Types.html#None"><span class="hs-identifier hs-var">None</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-comment">-- | applyTo acts differently, so we need a separate method</span><span>
</span><span id="line-96"></span><span class="annot"><a href="HsProof.Proof.html#imply"><span class="hs-identifier hs-type">imply</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HsProof.Types.html#Theorem%27"><span class="hs-identifier hs-type">Theorem'</span></a></span><span>
</span><span id="line-97"></span><span id="imply"><span class="annot"><span class="annottext">imply :: [Prop] -&gt; Either Result Prop
</span><a href="HsProof.Proof.html#imply"><span class="hs-identifier hs-var hs-var">imply</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679140052"><span class="annot"><span class="annottext">t :: Prop
</span><a href="#local-6989586621679140052"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679140051"><span class="annot"><span class="annottext">p :: Prop
</span><a href="#local-6989586621679140051"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><a href="HsProof.Types.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span>  </span><span id="local-6989586621679140050"><span class="annot"><span class="annottext">q :: Prop
</span><a href="#local-6989586621679140050"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679140049"><span class="annot"><span class="annottext">h :: Prop
</span><a href="#local-6989586621679140049"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679140051"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Prop -&gt; Prop -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679140049"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Prop -&gt; Either Result Prop
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679140050"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Either Result Prop
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(Result -&gt; Either Result Prop) -&gt; Result -&gt; Either Result Prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Prop -&gt; Result
</span><a href="HsProof.Types.html#Failed"><span class="hs-identifier hs-var">Failed</span></a></span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679140052"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-98"></span><span class="annot"><a href="HsProof.Proof.html#imply"><span class="hs-identifier hs-var">imply</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679140048"><span class="annot"><span class="annottext">t :: Prop
</span><a href="#local-6989586621679140048"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span> </span><span class="annot"><a href="HsProof.Types.html#%3A%3C-%3E"><span class="hs-operator hs-type">:&lt;-&gt;</span></a></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679140046"><span class="annot"><span class="annottext">h :: Prop
</span><a href="#local-6989586621679140046"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prop -&gt; Prop -&gt; Either Result Prop
forall a b. Appliable a b =&gt; a -&gt; b -&gt; Either Result Prop
</span><a href="HsProof.Types.html#app"><span class="hs-identifier hs-var">app</span></a></span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679140048"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679140046"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-99"></span><span class="annot"><a href="HsProof.Proof.html#imply"><span class="hs-identifier hs-var">imply</span></a></span><span> </span><span class="hs-identifier">_</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Either Result Prop
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(Result -&gt; Either Result Prop) -&gt; Result -&gt; Either Result Prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Prop -&gt; Result
</span><a href="HsProof.Types.html#Failed"><span class="hs-identifier hs-var">Failed</span></a></span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="HsProof.Types.html#None"><span class="hs-identifier hs-var">None</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-comment">-- | lift a &lt;Prop&gt; to &lt;Theorem&gt; using ObjectId</span><span>
</span><span id="line-102"></span><span class="annot"><a href="HsProof.Proof.html#theorem%27"><span class="hs-identifier hs-type">theorem'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HsProof.Types.html#ObjectId"><span class="hs-identifier hs-type">ObjectId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HsProof.Types.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="HsProof.Types.html#Theorem"><span class="hs-identifier hs-type">Theorem</span></a></span><span>
</span><span id="line-103"></span><span id="theorem%27"><span class="annot"><span class="annottext">theorem' :: ObjectId -&gt; Proof (Prop -&gt; Either Result Prop)
</span><a href="HsProof.Proof.html#theorem%27"><span class="hs-identifier hs-var hs-var">theorem'</span></a></span></span><span> </span><span id="local-6989586621679140043"><span class="annot"><span class="annottext">i :: ObjectId
</span><a href="#local-6989586621679140043"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-104"></span><span>    </span><span id="local-6989586621679140042"><span class="annot"><span class="annottext">PropRef
</span><a href="#local-6989586621679140042"><span class="hs-identifier hs-var">ref</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT PropRef Identity PropRef
-&gt; ExceptT Result (StateT PropRef Identity) PropRef
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">StateT PropRef Identity PropRef
forall (m :: * -&gt; *) s. Monad m =&gt; StateT s m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-105"></span><span>    </span><span id="local-6989586621679140041"><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679140041"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ObjectId -&gt; Proof Prop
</span><a href="HsProof.ProofRef.html#getProofObject"><span class="hs-identifier hs-var">getProofObject</span></a></span><span> </span><span class="annot"><span class="annottext">ObjectId
</span><a href="#local-6989586621679140043"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><span class="annottext">(Prop -&gt; Either Result Prop) -&gt; Proof (Prop -&gt; Either Result Prop)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((Prop -&gt; Either Result Prop)
 -&gt; Proof (Prop -&gt; Either Result Prop))
-&gt; (Prop -&gt; Either Result Prop)
-&gt; Proof (Prop -&gt; Either Result Prop)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Prop -&gt; Prop -&gt; Either Result Prop
</span><a href="HsProof.Proof.html#theorem"><span class="hs-identifier hs-var">theorem</span></a></span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679140041"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">-- | lifts a &lt;Prop&gt; to &lt;Theorem&gt;</span><span>
</span><span id="line-109"></span><span class="annot"><a href="HsProof.Proof.html#theorem"><span class="hs-identifier hs-type">theorem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HsProof.Types.html#Prop"><span class="hs-identifier hs-type">Prop</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HsProof.Types.html#Theorem"><span class="hs-identifier hs-type">Theorem</span></a></span><span>
</span><span id="line-110"></span><span id="theorem"><span class="annot"><span class="annottext">theorem :: Prop -&gt; Prop -&gt; Either Result Prop
</span><a href="HsProof.Proof.html#theorem"><span class="hs-identifier hs-var hs-var">theorem</span></a></span></span><span> </span><span id="local-6989586621679140039"><span class="annot"><span class="annottext">t :: Prop
</span><a href="#local-6989586621679140039"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679140038"><span class="annot"><span class="annottext">p :: Prop
</span><a href="#local-6989586621679140038"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><a href="HsProof.Types.html#%3A-%3E"><span class="hs-operator hs-type">:-&gt;</span></a></span><span>  </span><span id="local-6989586621679140037"><span class="annot"><span class="annottext">q :: Prop
</span><a href="#local-6989586621679140037"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679140036"><span class="annot"><span class="annottext">h :: Prop
</span><a href="#local-6989586621679140036"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Prop] -&gt; Either Result Prop
</span><a href="HsProof.Proof.html#imply"><span class="hs-identifier hs-var">imply</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679140039"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679140036"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-111"></span><span class="annot"><a href="HsProof.Proof.html#theorem"><span class="hs-identifier hs-var">theorem</span></a></span><span> </span><span id="local-6989586621679140035"><span class="annot"><span class="annottext">t :: Prop
</span><a href="#local-6989586621679140035"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679140034"><span class="annot"><span class="annottext">p :: Prop
</span><a href="#local-6989586621679140034"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><a href="HsProof.Types.html#%3A%3C-%3E"><span class="hs-operator hs-type">:&lt;-&gt;</span></a></span><span> </span><span id="local-6989586621679140033"><span class="annot"><span class="annottext">q :: Prop
</span><a href="#local-6989586621679140033"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679140032"><span class="annot"><span class="annottext">h :: Prop
</span><a href="#local-6989586621679140032"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Prop] -&gt; Either Result Prop
</span><a href="HsProof.Proof.html#imply"><span class="hs-identifier hs-var">imply</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679140035"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="#local-6989586621679140032"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-112"></span><span class="annot"><a href="HsProof.Proof.html#theorem"><span class="hs-identifier hs-var">theorem</span></a></span><span> </span><span class="hs-identifier">_</span><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Either Result Prop
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(Result -&gt; Either Result Prop) -&gt; Result -&gt; Either Result Prop
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Prop -&gt; Result
</span><a href="HsProof.Types.html#Failed"><span class="hs-identifier hs-var">Failed</span></a></span><span> </span><span class="annot"><span class="annottext">Prop
</span><a href="HsProof.Types.html#None"><span class="hs-identifier hs-var">None</span></a></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-comment">-- | lifted (&gt;=&gt;) combining theorems: (a -&gt; b) -&gt; (b -&gt; c) =&gt; (a -&gt; c)</span><span>
</span><span id="line-115"></span><span class="annot"><a href="HsProof.Proof.html#%3E%24%3E"><span class="hs-operator hs-type">(&gt;$&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HsProof.Types.html#ObjectId"><span class="hs-identifier hs-type">ObjectId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HsProof.Types.html#ObjectId"><span class="hs-identifier hs-type">ObjectId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HsProof.Types.html#Proof"><span class="hs-identifier hs-type">Proof</span></a></span><span> </span><span class="annot"><a href="HsProof.Types.html#Theorem"><span class="hs-identifier hs-type">Theorem</span></a></span><span>
</span><span id="line-116"></span><span id="local-6989586621679140030"><span class="annot"><span class="annottext">p :: ObjectId
</span><a href="#local-6989586621679140030"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="%3E%24%3E"><span class="annot"><span class="annottext">&gt;$&gt; :: ObjectId -&gt; ObjectId -&gt; Proof (Prop -&gt; Either Result Prop)
</span><a href="HsProof.Proof.html#%3E%24%3E"><span class="hs-operator hs-var hs-var">&gt;$&gt;</span></a></span></span><span> </span><span id="local-6989586621679140029"><span class="annot"><span class="annottext">q :: ObjectId
</span><a href="#local-6989586621679140029"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Prop -&gt; Either Result Prop)
-&gt; (Prop -&gt; Either Result Prop) -&gt; Prop -&gt; Either Result Prop
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">(&gt;=&gt;)</span></span><span> </span><span class="annot"><span class="annottext">((Prop -&gt; Either Result Prop)
 -&gt; (Prop -&gt; Either Result Prop) -&gt; Prop -&gt; Either Result Prop)
-&gt; Proof (Prop -&gt; Either Result Prop)
-&gt; ExceptT
     Result
     (StateT PropRef Identity)
     ((Prop -&gt; Either Result Prop) -&gt; Prop -&gt; Either Result Prop)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ObjectId -&gt; Proof (Prop -&gt; Either Result Prop)
</span><a href="HsProof.Proof.html#theorem%27"><span class="hs-identifier hs-var">theorem'</span></a></span><span> </span><span class="annot"><span class="annottext">ObjectId
</span><a href="#local-6989586621679140030"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT
  Result
  (StateT PropRef Identity)
  ((Prop -&gt; Either Result Prop) -&gt; Prop -&gt; Either Result Prop)
-&gt; Proof (Prop -&gt; Either Result Prop)
-&gt; Proof (Prop -&gt; Either Result Prop)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ObjectId -&gt; Proof (Prop -&gt; Either Result Prop)
</span><a href="HsProof.Proof.html#theorem%27"><span class="hs-identifier hs-var">theorem'</span></a></span><span> </span><span class="annot"><span class="annottext">ObjectId
</span><a href="#local-6989586621679140029"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-117"></span></pre></body></html>